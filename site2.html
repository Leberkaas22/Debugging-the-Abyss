<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Debugging the Abyss</title>
  <style>
    :root{
      --col-gap: clamp(6px, .8vw, 12px);
      --imgColW: min(40vw, 620px);
      --textColW: min(33vw, 520px);
      --textMax: 38ch;
      --headingMax: 22ch;
      --bg:#000; --fg:#fff; --muted:#cfcfcf;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      line-height:1.5; overflow:hidden;   /* virtual scroll */
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    .viewport{ position:fixed; inset:0; height:100vh; perspective:1000px; }
    .scene{ position:relative; width:100%; height:100%; transform-style:preserve-3d; }

    .row{
      position:absolute; left:0; right:0; top:50%; margin-inline:auto;
      display:grid; grid-template-columns:minmax(0,var(--imgColW)) minmax(0,var(--textColW));
      align-items:center; justify-content:center; column-gap:var(--col-gap);
      width:min(92vw,1600px); transform-style:preserve-3d;
      will-change:transform,opacity,filter; transform:translate3d(0,-50%,0) scale(0.9);
      padding:0 20px; isolation:isolate;
    }
    .row.compact{ --col-gap:clamp(4px,.6vw,10px); --imgColW:min(36vw,560px); --textColW:min(30vw,480px); }
    .row:nth-child(even) .alpha{ order:2; }
    .row:nth-child(even) .beta { order:1; }

    .alpha{ position:relative; z-index:1; }
    .alpha img{
      width:100%; height:auto; max-height:68vh; object-fit:contain; display:block;
      filter:grayscale(100%); transition:opacity 10ms linear; pointer-events:none;
    }

    .beta{ position:relative; z-index:5; max-width:var(--textColW); }
    .beta h2{
      margin:0 0 .35em 0; font-weight:700;
      font-size:clamp(1.05rem,1.6vw + .55rem,1.75rem);
      line-height:1.15; max-width:var(--headingMax);
      text-wrap:balance; hyphens:none; -webkit-hyphens:none; overflow-wrap:break-word;
    }
    .beta p{
      margin:0; color:var(--muted);
      font-size:clamp(.95rem,.65vw + .7rem,1.02rem);
      max-width:var(--textMax); text-wrap:pretty;
      hyphens:none; -webkit-hyphens:none; overflow-wrap:break-word; word-break:normal;
    }

    /* Darkness overlay — ramps in after deepest section */
    #darkvoid{
      position:fixed; inset:0; z-index:2; background:#000; opacity:0; pointer-events:none;
      transition: opacity 60ms linear;
    }

    @media (max-width:980px){
      :root{ --textMax:28ch; --headingMax:20ch; }
      .row{ grid-template-columns:1fr; row-gap:14px; column-gap:0; justify-content:center; text-align:left; }
      .alpha img{ max-height:56vh; }
      .beta{ max-width:92vw; }
    }
  </style>
</head>
<body>
  <!-- Darkness tail -->
  <div id="darkvoid" aria-hidden="true"></div>

  <!-- Content -->
  <div class="viewport">
    <div class="scene" id="scene">
      <section class="row" data-z="-8800">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/bild117.gif" alt="startled" /></figure>
        <div class="beta">
          <h2>It really seems like that if we try to cognize what makes reality go round we get reminded of that the Human Experience is a lot about being confronted about our limits, and how often there’s nothing we can do about these.</h2>
          <p>The future seems to hold possibilities of that we might grow beyond our biological bodies. Following that progress, going endlessly further could quickly be the same as falling endlessly down.</p>
        </div>
      </section>

      <section class="row" data-z="-7500">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/bug.png" alt="startled" /></figure>
        <div class="beta">
          <h2>The Bug</h2>
          <p>The Idea coming from the fact that sometimes when I get into an emotionally overwhelmed phase I can develop an incredible fear of missing out that I will never know or experience everything there is or ever cognise the absolute.</p>
        </div>
      </section>

      <section class="row compact" data-z="-6250">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/story.png" alt="story" /></figure>
        <div class="beta">
          <h2>Sketches</h2>
          <p>To achieve this I worked with the framework of a story narrative since navigating this topic can become really challenging really fast.</p>
        </div>
      </section>

      <section class="row" data-z="-5000">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/camus.png" alt="camus" /></figure>
        <div class="beta">
          <h2>Philosophical inspiration</h2>
          <p>Inspired by Albert Camus’ “The Myth of Sisyphus”, I wanted to illustrate this seemingly contradictory aspect of the human lived experience.</p>
        </div>
      </section>

      <section class="row compact" data-z="-3750">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/bild4178.gif" alt="character" /></figure>
        <div class="beta">
          <h2>Character</h2>
          <p>For the story I chose to make it a startled and confused character that goes through this dilemma, debugging it by thinking about it and recognising molding his own way of thinking.</p>
        </div>
      </section>

      <section class="row" data-z="-2800">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/bild618.gif" alt="animation" /></figure>
        <div class="beta">
          <h2>Animating</h2>
          <p>After some sketches I drew and animated the images.</p>
        </div>
      </section>

      <section class="row compact" data-z="-1550">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/code.png" alt="code" /></figure>
        <div class="beta">
          <h2>Coding</h2>
          <p>With the help of LLMs I built the basic framework and then finessed the details, order and arrangement on my own.</p>
        </div>
      </section>

      <!-- First visible read -->
      <section class="row" data-z="-300" id="finishing-row">
        <figure class="alpha"><img src="/Users/lea/Desktop/Y3/Suomi/Epi/inspct.png" alt="" /></figure>
        <div class="beta" id="finishing-text">
          <h2>Finishing touches</h2>
          <p>After having Version 0 prototype I added further animations to the typography and adjusted the ending a little bit to comment on the meta-narrative I used.</p>
        </div>
      </section>
    </div>
  </div>

  <script>
    // ===== Minimal 3D engine + darkness tail + parent messaging =====
    const rows = [...document.querySelectorAll('.row')];

    // Feel
    const SPEED = 0.55;
    const FRICTION = 0.08;
    const CLEAR_RADIUS = 160;
    const FALLOFF = 900;

    // Visual shaping
    const IMG_MIN_BLUR = 0.4;
    const IMG_MAX_BLUR = 16;
    const IMG_MIN_OPAC = 0.22;
    const TXT_MAX_BLUR = 4.0;
    const TXT_MIN_OPAC = 0.35;

    // Darkness tail
    const DARK_START_OFFSET = 800;   // px after farthest content
    const DARK_SPAN = 1800;          // fade length to full black

    const clamp = (v,min,max)=>Math.max(min,Math.min(max,v));
    const lerp = (a,b,t)=>a+(b-a)*t;
    const smoothstep = (t)=>t*t*(3-2*t);

    let virtual = 0;
    const zs = rows.map(r => +r.dataset.z || 0);
    const farthest = Math.min(...zs);            // most negative (e.g., -8800)
    const EXTRA_TAIL = DARK_START_OFFSET + DARK_SPAN + 800;
    const MAX_TRAVEL = Math.abs(farthest) + EXTRA_TAIL;

    let cameraZ = 0, targetZ = 0;

    const darkvoid = document.getElementById('darkvoid');

    // parent comms
    let lastSend = 0;
    function sendProgress(){
      const now = performance.now();
      if (now - lastSend > 80){
        window.parent?.postMessage({ type:'site2-progress', virtual }, '*');
        lastSend = now;
      }
    }

    // Inputs
    window.addEventListener('wheel', (e)=>{
      e.preventDefault();
      virtual = clamp(virtual + e.deltaY * SPEED, 0, MAX_TRAVEL);
    }, { passive:false });

    window.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){ window.parent?.postMessage({type:'site2-exit'}, '*'); return; }
      const step = (e.shiftKey ? 160 : 70);
      if(e.key==='ArrowDown'||e.key==='s'||e.key==='S'||e.key==='PageDown'||e.key===' '){
        virtual = clamp(virtual + step, 0, MAX_TRAVEL);
      }else if(e.key==='ArrowUp'||e.key==='w'||e.key==='W'||e.key==='PageUp'){
        virtual = clamp(virtual - step, 0, MAX_TRAVEL);
      }
    });

    let touchY = null;
    window.addEventListener('touchstart', (e)=>{ touchY = e.touches[0].clientY; }, {passive:true});
    window.addEventListener('touchmove', (e)=>{
      if(touchY == null) return;
      const y = e.touches[0].clientY;
      const dy = touchY - y; // swipe up → forward
      touchY = y;
      virtual = clamp(virtual + dy * 2.0, 0, MAX_TRAVEL);
    }, {passive:true});
    window.addEventListener('touchend', ()=>{ touchY = null; }, {passive:true});

    function update(){
      // camera
      targetZ = -virtual;
      cameraZ = lerp(cameraZ, targetZ, FRICTION);

      rows.forEach((row)=>{
        const baseZ = +row.dataset.z || 0;
        const zRel = baseZ - cameraZ;

        // position & scale
        const near = Math.max(0, 1 - Math.min(1, Math.abs(zRel) / 2000));
        const scale = 0.9 + near * 0.2;
        row.style.transform = `translate3d(0, -50%, ${zRel}px) scale(${scale.toFixed(3)})`;

        // focus shaping
        const d = Math.abs(zRel);
        const t = (d <= CLEAR_RADIUS) ? 0 : Math.min(1, (d - CLEAR_RADIUS) / FALLOFF);
        const e = smoothstep(t);

        const img = row.querySelector('.alpha img');
        if(img){
          const imgOpacity = 1 - e * (1 - IMG_MIN_OPAC);
          const imgBlur = IMG_MIN_BLUR + e * (IMG_MAX_BLUR - IMG_MIN_BLUR);
          img.style.opacity = imgOpacity.toFixed(3);
          img.style.filter = `grayscale(100%) blur(${imgBlur.toFixed(2)}px)`;
        }
        const text = row.querySelector('.beta');
        if(text){
          const textOpacity = 1 - e * (1 - TXT_MIN_OPAC);
          const textBlur = e * TXT_MAX_BLUR;
          text.style.opacity = textOpacity.toFixed(3);
          text.style.filter = `blur(${textBlur.toFixed(2)}px)`;
        }
      });

      // Darkness tail beyond deepest section
      const far = Math.abs(farthest);
      const beyond = Math.max(0, virtual - (far + DARK_START_OFFSET));
      const darkAlpha = Math.min(1, beyond / DARK_SPAN);
      darkvoid.style.opacity = darkAlpha.toFixed(3);

      sendProgress();
      requestAnimationFrame(update);
    }

    // Init transforms
    rows.forEach(r=>{
      const baseZ = +r.dataset.z || 0;
      r.style.transform = `translate3d(0, -50%, ${baseZ}px) scale(0.9)`;
      const text = r.querySelector('.beta'); if(text){ text.style.opacity = 0.85; text.style.filter = 'blur(0px)'; }
      const img  = r.querySelector('.alpha img'); if(img){ img.style.opacity = 0.22; img.style.filter = 'grayscale(100%) blur(10px)'; }
    });

    // Parent reset
    window.addEventListener('message', (ev)=>{
      const data = ev.data || {};
      if (data.type === 'site2-reset' || data.type === 'site2-exit'){
        virtual = 0; cameraZ = 0; targetZ = 0;
        darkvoid.style.opacity = '0';
      }
    });

    requestAnimationFrame(update);
  </script>
</body>
</html>
